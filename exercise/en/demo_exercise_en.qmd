---
title: "Show case of outbreak-tools usage"
subtitle: ""
lang: en
format: 
    html: 
      theme: default
      toc: true
      standalone: true
      embed-resources: true
    pdf: default
    docx: default
authors:
    - name: Anton Camacho
      affiliations:
        - ref: epicentre
    - name: Yves Amevoin
      affiliations:
        - ref: epicentre
    - name: Marine Durthaler
      affiliations:
        - ref: epicentre
affiliations:
    - id: epicentre
      name: Epicentre Research Center
      url: https://epicentre.msf.org/
---

## Introduction

Outbreak-tools is a set of tools to facilitate the creation of linelists
in Excel. Among other things, these tools allow you to automate:

- Adding variables (whether drop-down lists, integer or decimal values, or even Excel formulas) and format them. 
- Translating a linelist from one language to another,
- Adding analyses to the linelist in tabular form (univariate, bivariate, temporal, spatial),
- Adding graphs to the linelist,
- Import/export the entire linelist or selected variables into specific formats.
- Managing geographic data in the linelist.
- Migration of the linelist as options/variables are added or removed.


```{mermaid theme="neutral"}

%%|fig.width: 2

flowchart TD
A[Setup File] --> B[Designer File]
G[Geobase] -->B
B --> C[Linelist v.1]
C --> F(Upgrading to a new version)
C --> E(Export: MSF, MoH, Raw data.)
E --> I(Import in new version)
E --> H(Share, centralise)
F --> K[Linelist v.2]
I --> K
```

The linelist is designed in a configuration file
called _setup_. This _setup_ file is then loaded into another file that designs the linelist
called _designer_. The designer creates the linelist, based on the configurations
of the _setup_. The linelist creation procedure is a 3-step process:


1- Define your needs in the setup file: 
The configuration of the file is inspired from Kobo's XLS forms. No in-depth knowledge of Excel is required. A setup file is defined by disease, and can be used to create linelists in several languages.


2- Download geographic data for the targeted area:
There is [an application](https://reports.msf.net/secure/app/outbreak-tools-geoapp) available online to download geographic data for the region of interest. It is updated as new geographical information becomes available.

3- Generate the linelist by specifying the options in the designer.


# Exercises

This series of 3 exercises explores the possibilities mentioned above, using a
measles setup file. The folders contain all the materials needed to perform 
the exercises. 

::: {.callout-note title = "Download and unzip the materials"}
  You can download the exercices in `zip` file for offline use 
  [here](). **Extract the zip files after the download.** 
:::


::: {.callout-important title="Activate macros before exercises"}

  If you're going to run the designer to build a linelist, you'll need to enable VBA macros in Excel, as well as access to the VBA object model:

  0- Open Excel

  1- Display the _Developer_ tab in Excel.

  2- In the _Developer_ tab, click on _Macro security_. Check the options as shown in the following image:

  ![](macros_security_en.png){width=80% fig-align="center"}


  On some Windows machine, you will need to unblock your files to be able to use macros. 
  In some cases, excel macro files
  downloaded from the web are automatically blocked for security reasons. You can unblock the files 
  by:

  0- Right click on the file
  
  1- Select Properties

  2- Check the _Unblock_ box on the bottom right. 

:::



## Exercise 1: Exploration.

- Open the file `linelist_measles_en_ex1.xlsb`. The file password is 5678.

- Browse the linelist sheets.

- Fill in geographical data using the geo-Helper. Select the data you want.

- Explore univariate, bivariate and temporal analyses. Recompute the same analyses by filtering on people under 2 years of age.

- Export the filtered data with the anonymous export for MSF. If you don't change the export password, the password is 605637.

## Exercise 2: Modifying the setup file

- Open the setup file `setup_measles_base_ex2.xlsb`. We want to add the following variables:

  - In the _Admission_ section of _Linelist patients_ sheet, just before the _hospitalisation_ sub-section:
    - `muac` (MUAC) which takes three values: "Green (125+mm)", "Yellow (115-124mm)", "Red (< 115mm)"

  - In the _Vaccination_  section of _Linelist patients_ sheet, just after _Vaccination against measles_:
    - `vacci_measles_doses` (Number of doses received) which is a numeric variable.
    - Add a validation to this variable to make sure it's between 0 and 4.

- Translate the added labels into French

- Check the setup for errors.


::: {.callout-note}
_You should normally have a configuration file identical to `setup_measles_exercise_two.xlsb`. You can also start from this file if you like._
:::

- Regenerate a new linelist with the designer named 
`linelist_measles_en_ex2` in the demo folder, making sure you've selected English as the language. 
You'll use the file `geobase-cod-2023-03-13_20230612.xlsb` as your geobase.

- Import the data `import_linelist_en.xlsx` into the linelist. Look at the data that has not been imported and browse the data in the generated linelist. 


## Exercise 3: Analysis

We've decided to add some analyses to the `outcome` file.

- Open the setup `setup_measles_base_ex3.xlsb`.

- In the analyses sheet, add a univariate table showing the number of patients by type of discharge. Add percentages and a graph for this table.

- In the analyses sheet, add a temporal table showing the evolution of type of discharge by notification date. Add a percentage option in row, and add a total.

- In the analysis sheet, add a graph of output types. In
graph specifications, represent the number of deaths per notification date, in bars.

- Translate all labels into French

- Check the setup for errors.

::: {.callout-note}
_You should get a configuration file identical to `setup_measles_exercise_three.xlsb`. You can also start from this file if you like._
:::


- Regenerate a new linelist with the designer called 
`linelist_measles_en_ex3` in the demo folder, making sure you've selected English as the language.

- Import the data `import_linelist_en.xlsb` into the linelist. Browse the generated linelist data.


- Print the `Patient linelist` sheet.