---
title: "Utilisation d'une linelist de Outbreak Tools"
subtitle: ""
lang: fr
format: 
    html: 
      theme: default
      toc: true
      standalone: true
    pdf: default
    docx: default
authors:
    - name: Yves Amevoin
      affiliations:
        - ref: epicentre
    - name: Mathilde Mousset
      affiliations:
        - ref: epicentre
affiliations:
    - id: epicentre
      name: Epicentre Research Center
      url: https://epicentre.msf.org/
---

# Introduction

Outbreak-tools est un ensemble d'outils destinés à faciliter la création et 
la maintenance de linelists Excel. En particulier, vous pouvez facilement :

- Définir différents types de variables (listes déroulantes, formules Excel), 
leur format et les règles de validation des données.
- Imprimer un registre qui correspond à votre linelist.
- Traduire votre liste en plusieurs langues.
- Utiliser des bases de données géographiques prédéfinies pour l'origine des patients.
- Afficher des analyses personnalisées (univariées, bivariées, temporelles, spatiales) sous forme de tableaux et de graphiques.
- Exporter l'ensemble des données ou des variables/lignes sélectionnées.
- Migrer les données vers une version mise à jour de la liste des lignes.

La linelist est définie dans un fichier de configuration appelé *setup*. 
Ce fichier *setup* est ensuite chargé dans un autre fichier qui conçoit 
linelist appelé  *designer*. 
Le *designer* crée la linelist en se basant sur les configurations du *setup*.

L'objectif de cet exercice est d'explorer les fonctionnalités et l'utilisation d'une linelist rougeole
qui contient des données fictives.


::: {.callout-important title="Présentation des fonctionnalités"}

  Les fonctionalités sont décrites dans un guide utilisateur transmis avec cet exercice. 
  Vous pouvez 
  le parcourir plus tard pour avoir une idée de toutes les fonctionalités disponibles. 
  Nous n'allons parcourir que quelques-unes dans la linelist présentées à partir des deux schémas suivants :

:::

::: {#fig-fonctionalites layout-nrow=2}

  ![Pour débuter](./imgs/getting-started_fr.png){#fig-start}

  ![Fonctionalités](./imgs/features_fr.png){#fig-feature}

  Fonctionnalités de la linelist
:::



## Exercice : Utilisation des fonctionnalités de la linelist

Vous disposez d'une linelist nommée `linelist_measles_usage_fr.xlsb`, et d'une feuille excel 
contenant des données appelée `import_linelist_fr.xlsb`.
Nous allons explorer la linelist après avoir importé les données de la feuille, et
répondre à certaines questions.


#### 1- Découvrir la feuille de saisie de données. 


*Trier des données*

Triez les données  de la colonne `Numéro d'identification`. 

Pour cela,
Cliquez sur la cellule `$A$9`, puis
dans l'onglet `OutbreakTools`,
 cliquez sur le bouton `Trier la variable`.

::: {.callout-tip title="Question" icon="false"}

Que remarquez-vous ?

:::


Triez maintenant les données sur la colonne `Numéro d'identification calculé`.

*Afficher/Cacher des variables*

Dans l'onglet `OutbreakTools`, cliquez sur
`Afficher/Masquer les variables`.
Cachez les trois premières variables personalisées.

#### 2- Saisir des données

::: {.callout-note title="Aide au remplissage" icon="false"}

  Le GeoHelper permet d'entrer les données sur les origines géographiques en cascade.

  ![Geo Helper](imgs/geo-helper_fr.png)

  Certaines colonnes sont des listes déroulantes personnalisées (par ex une colonne pour une
  localité qui ne se trouve pas dans la géobase). Vous pouvez les remplir en utilisant
  les listes déroulantes personalisées.

  ![Custom Dropdowns](imgs/custom-dropdown_fr.png)

:::

Vous diposez des données pour les deux patients suivants:

```
  Patient 1 :

  Date de notification : 2023-10-22
  Nom et prénom : John Doe
  Sexe : Masculin
  Age : 3 ans
  Origine : Lualabala, Kapanga, Kanampumb, Kasankara
  Date d'apparition des symptomes : 2023-10-18
  Date d'hospitalisation : 2023-10-25
  Vacciné contre la rougeole : non
  Date de sortie : 2023-11-01 (Décédé)

  Patient 2 :

  Numéro Identifiant : 44
  Date de notification : 2023-11-05
  Nom : Jane Doe
  Sexe : Féminin
  Age : 7 mois
  Origine : Lualabala, Kapanga, Mulambu, Mulambu
  Date d'apparition des symptomes : 2023-11-04
  Date d'hospitalisation : 2023-11-10
  Statut vaccinal : inconnu
  Date de sortie : 2023-11-12 (Guéri)
```

::: {.callout-tip title="Questions" icon="false"}

Saisissez ces données.

Filtrez la colonne `Date d'apparition des symptômes`. Avez-vous
des données incohérentes ? Corrigez-les.

:::

#### 3- Parcourir les analyses

Cliquez sur la feuille `Analyses Uni et bi-variées`.

*Apperçu global, analyses univariées*

Dans l'onglet `OutbreakTools`, cliquez sur `Actualiser les analyses`.

::: {.callout-tip title="Questions" icon="false"}

Combien de patients avez-vous dans la base de données ?

Quelle est la létalité ?

Quelle est la proportion des enfants de moins de 5 ans ?

:::

*Analyses sur des données filtrées*

Cliquez sur la feuille `Linelist patients` et filtrez la 
colonne `Tranche d'âge` pour ne garder que les enfants de moins de 5 ans.

Cliquez sur la feuille `Analyses Uni et bi-variées` puis cliquez sur
`Actualiser les analyses` dans l'onglet `OutbreakTools`.

Vous disposez maintenant des analyses que sur les données que vous avez filtrez.

::: {.callout-tip title="Question" icon="false"}

Quelle est la létalité des enfants de moins de 5 ans ?

:::

*Analyses bivariées*

Cliquez sur la feuille `Linelist patients`.

Dans l'onglet `OutbreakTools`, dans la section `Tableau de données`,
cliquez sur `Supprimer tous les filtres`.

Cliquez sur la feuille `Analyses uni et bi-variées`.

Cliquez sur la cellule `$C$2` où est écrit `Aller à la section`, 
puis sélectionnez la section `Caractéristiques de l'âge des patients`.
Rappelez-vous d'actualiser les analyses.

::: {.callout-tip title="Questions" icon="false"}

Parmi les patients non vaccinés, quel est le groupe d'âge le plus
représenté ?

Y a t-il des patients adultes (de plus de 15 ans) décédés ? Combien ?

:::

*Analyses temporelles*

Cliquez sur la feuille `Analyses temporelles`, et actualisez les analyses
comme précédemment.

Dans la cellule `$G$11$`, choisissez comme unité temporelle le mois.

Dans la cellule `$E$11`, mettez comme date de début 2019-01-01

::: { .callout-tip title="Questions" icon="false"}

Au cours de l'année 2019, dans quel mois a-t-on eu le plus de cas ?

Au cours de ce mois de l'année 2019, dans quelle semaine épidémiologique as-ton eu plus de cas ?

En général au cours de l'épidémie, dans quelle semaine épidémiologique
as-ton eu le plus de cas ?

Au cours de cette semaine, quelle est la létalité ?

:::


*Vous pourrez utiliser les filtres dans la feuille `Linelist patients` pour répondre à ces questions*

Quelle est la létalité des moins de 5 ans au cours de la semaine épidémiologique où l'on a eu le plus de cas ? 

Dans quelle semaine épidémiologique a-t-on enregistré le plus de décès ?


*Analyses spatiales*

Cliquez sur la feuille `Analyses spatiales` et actualisez les analyses
comme précédement.

Dans la cellule `$C$14$`, Sélectionnez l'option `Aire de Santé`.

::: { .callout-tip title="Questions" icon="false"}

Combien de patients n'ont pas d'information sur leur origine ?

Quelle est l'aire de santé la plus touchée ? Nous garderons son nom pour l'utiliser plus tard.

D'où viennent la plupart des patients qui décèdent ?

:::


*Analyses spatio-temporelles*

Vous vous rappelez qu'il a fallu garder en tête l'aire de santé la plus touchée.

Cliquez sur la feuille `Analyses spatio-temporelles`.

Dans la cellule `$C$14`, cliquez deux fois. Une boîte pour choisir 
des localités s'affiche.

Sélectionnez l'aire de santé la plus touchée. Vous pouvez vous arrêter au
niveau 3 puis cliquez sur OK.

Actualisez ensuite les analyses comme précédement.


::: { .callout-tip title="Question" icon="false"}

Au cours de l'épidémie, cette aire de santé a connu le plus de cas quelle semaine ?

:::

Vous pouvez choisir jusqu'à 10 aires de santé et les visualiser sur un
graphe si vous le voulez.


#### 4- Exporter les données

Dans l'onglet `OutbreakTools`, cliquez sur
`Exporter les données`.

Cliquez sur `Exportation anonyme pour le MoH`. Choisissez où vous
vouler enregistrer l'export.

Faites de même en cliquant sur  `Exportation anonyme pour MSF`. C'est 
cet export qui est envoyé au dashboard. Il ne faut pas renommer le fichier exporté.
Vous pouvez l'ouvrir pour explorer les données et regarder
les différences entre les deux exports (MoH et MSF). 
Le mot de passe est 1234.


#### 5- (Bonus) Importer des données

Dans l'onglet `OutbreakTools`, dans la section `Imports`, cliquez
sur le bouton `Importer des données`. Naviguez et sélectionnez le fichier
`import_linelist_fr.xlsb` puis validez.
Ajoutez les données du fichier à celles déjà présentes dans la linelist.
A la fin de l'import, on vous demandera si vous voulez voir un rapport. 
Sélectionnez "Oui".


::: {.callout-tip title="Question" icon="false"}

Quelles sont les variables qui ne sont pas disponibles dans les données importées ?

:::

